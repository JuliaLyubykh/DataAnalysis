import pandas as pd
import numpy as np
import seaborn as sns
from tabulate import tabulate
import matplotlib.pyplot as plt
import re
import scipy.stats
import statsmodels.stats
import plotly.express as px
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score

pd.set_option('display.max_columns', None)

#загружаем данные
orig_dataset = pd.read_csv('C:/Users/kelly/HeartProblems.csv')

#создание копии датасета, чтобы не затронуть оригинальные данные без надобности
copy_dataset = orig_dataset

#вычисление количества строк и столбцов таблицы
copy_dataset.shape

#вычисление корреляций
correlation_matrix = copy_dataset.corr()

#визуализация корреляционной матрицы
figure = px.imshow(correlation_matrix)
figure.show()

#наименование столбцов таблицы
#column = copy_dataset.columns
#for i in range(len(column)):
#   print(column[i])

#вывод количества уникальных значений, нулевых и пустых значений + доля в % от общего количества по столбцам
def columnValues(copy_dataset):
  row = [copy_dataset.nunique(), (copy_dataset == 0).sum(axis=0), copy_dataset.isna().sum(), round(copy_dataset.isna().sum() / len(copy_dataset) * 100, 1), copy_dataset.dtypes]
  return row

data = []
for column in copy_dataset:
  data.append([column] + columnValues(copy_dataset[column]))

print(tabulate(data, headers = ['Название', 'Количество уникальных значений', 'Количество нулевых значений', 'Пустые', 'Процет пустых', 'Тип данных'], tablefmt='orgtbl'))





































